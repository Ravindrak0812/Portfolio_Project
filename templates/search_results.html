{% extends 'base.html' %}

{% block title %}Search Results{% endblock title %}

{% block body %}
{% load static %}

<style>
    /* Terminal Loader Styles */
    @keyframes blinkCursor {
        50% {
            border-right-color: transparent;
        }
    }

    @keyframes typeAndDelete {
        0%,
        10% {
            width: 0;
        }
        45%,
        55% {
            width: 6.2em; /* Adjust width based on text content */
        }
        90%,
        100% {
            width: 0;
        }
    }

    .terminal-loader {
        border: 0.1em solid #333;
        background-color: #1a1a1a;
        color: #0f0;
        font-family: "Courier New", Courier, monospace;
        font-size: 1.2em;
        padding: 1.5em 1em;
        width: 18em;
        max-width: 90vw;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
        overflow: hidden;
        box-sizing: border-box;
    }

    .terminal-header {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1.5em;
        background-color: #333;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
        padding: 0 0.4em;
        box-sizing: border-box;
    }

    .terminal-controls {
        float: right;
    }

    .control {
        display: inline-block;
        width: 0.6em;
        height: 0.6em;
        margin-left: 0.4em;
        border-radius: 50%;
        background-color: #777;
    }

    .control.close {
        background-color: #e33;
    }

    .control.minimize {
        background-color: #ee0;
    }

    .control.maximize {
        background-color: #0b0;
    }

    .terminal-title {
        float: left;
        line-height: 1.5em;
        color: #eee;
    }

    .text {
        display: inline-block;
        white-space: nowrap;
        overflow: hidden;
        border-right: 0.2em solid green; /* Cursor */
        animation:
            typeAndDelete 4s steps(11) infinite,
            blinkCursor 0.5s step-end infinite alternate;
        margin-top: 1.5em;
    }

    /* Content Section */
    .hidden {
        display: none;
        opacity: 0;
    }

    .fade-in {
        display: block;
        animation: fadeIn 1s ease-in forwards; /* 1s fade-in animation */
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    
    /* Blog Section Styling */
    .blog-section {
        padding-top: 30px;
    }

    .blog-section .blog-item {
        background: white;
        padding: 20px;
        margin: 10px 0;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .blog-item h4 {
        font-size: 1.8rem;
        margin-bottom: 10px;
    }

    .blog-item p {
        font-size: 1rem;
        color: #555;
    }

    .blog-item .btn {
        background-color: #007BFF;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
    }

    .blog-item .btn:hover {
        background-color: #0056b3;
    }

    .no-results {
        text-align: center;
        color: #555;
        font-size: 1.2rem;
        margin-top: 20px;
    }

    .read-more {
        color: #007BFF;
        cursor: pointer;
        text-decoration: underline;
    }

    /* Back to Blog Button */
    .back-to-blog {
        text-align: center;
        margin-top: 20px;
    }

    .back-to-blog a {
        padding: 10px 20px;
        font-size: 1.1rem;
        border: none;
        background-color: #28a745;
        color: white;
        border-radius: 5px;
        text-decoration: none;
    }

    .back-to-blog a:hover {
        background-color: #218838;
    }

</style>

<!-- Terminal Loader -->
<div id="loader" class="terminal-loader">
    <div class="terminal-header">
        <div class="terminal-title">Status</div>
        <div class="terminal-controls">
            <div class="control close"></div>
            <div class="control minimize"></div>
            <div class="control maximize"></div>
        </div>
    </div>
    <div class="text">Loading...</div>
</div>


<!-- Blog Section -->
<section id="services" class="services hidden blog-section">
    <div class="container">
        <div class="section-title">
            <h2>Search Results</h2>
        </div>
        <div class="row">
            {% if results %}
                {% for post in results %}
                    <div class="col-md-4 col-sm-6">
                        <div class="blog-item">
                            <div class="icon" style="border-radius:40%; height:50px; width:50px">
                                <img
                                    style="border-radius:40%"
                                    width="100%"
                                    height="100%"
                                    src="{{post.img.url}}"
                                    class="img-fluid"
                                    alt="no-image"
                                />
                            </div>
                            <h4 style="padding-left:20px">{{ post.title }}</h4>
                            <p id="description-{{ post.title|slugify }}">
                                {{ post.description|truncatewords:40 }}
                                <span class="read-more" onclick="toggleDescription('{{ post.title|slugify }}')">Read More</span>
                                <span class="full-description" style="display:none">{{ post.description }}</span>
                            </p>
                            <p><strong>Author:</strong> {{ post.authname }}</p>
                            <p><strong>Posted on:</strong> {{ post.timeStamp }}</p>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-results">
                    <p>No results found.</p>
                </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- Back to Blog Button -->
<div class="back-to-blog">
    <a href="{% url 'blog' %}">Back to Blog</a>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    // Show loader
    function showLoader() {
        $('#loader').removeClass('hidden');
    }

    // Hide loader and show content with animation
    function hideLoader() {
        $('#loader').addClass('hidden');
        $('#services').removeClass('hidden').addClass('fade-in');
    }

    $(document).ready(function () {
        showLoader();

        // Simulate loading completion after 2 seconds
        setTimeout(function () {
            hideLoader();
        }, 2000); // 2000ms = 2 seconds
    });

    // Function to toggle the full description
    function toggleDescription(postTitle) {
        const fullDescription = document.querySelector(`#description-${postTitle} .full-description`);
        const readMoreLink = document.querySelector(`#description-${postTitle} .read-more`);
        
        if (fullDescription.style.display === "none") {
            fullDescription.style.display = "inline";
            readMoreLink.textContent = "Read Less";
        } else {
            fullDescription.style.display = "none";
            readMoreLink.textContent = "Read More";
        }
    }
</script>

{% endblock body %}
